import './polyfills.server.mjs';
import{a as S}from"./chunk-PEC4KX2G.mjs";import{a as E}from"./chunk-HEZLGDGX.mjs";import{b as u,d as k,g as _,i as F,k as I,m as x}from"./chunk-OK7ZK6LL.mjs";import"./chunk-IT7UANVT.mjs";import{i as b,l as C}from"./chunk-FS4VX5NN.mjs";import"./chunk-LYQUDD53.mjs";import{Kb as g,Qa as o,W as l,Xb as p,ab as v,qb as h,rb as f,wb as s,xb as n,yb as c,zb as m}from"./chunk-F7B3EIZI.mjs";import"./chunk-X2SEQXRR.mjs";function L(r,t){r&1&&m(0,"i",10)}function T(r,t){r&1&&m(0,"i",10)}var P=class r{fb=l(I);paymentService=l(S);router=l(C);activatedRoute=l(b);checkoutForm;isLoading=!1;cartId="";ngOnInit(){this.getCartId(),this.initForm()}initForm(){this.checkoutForm=this.fb.group({shippingAddress:this.fb.group({details:[null,[u.required]],phone:[null,[u.required,u.pattern(/^01[0125][0-9]{8}$/)]],city:[null,[u.required]]})})}getCartId(){this.activatedRoute.paramMap.subscribe({next:t=>{this.cartId=t.get("cid"),console.log(this.cartId)}})}payByCash(t){this.checkoutForm.valid&&(t.preventDefault(),this.isLoading=!0,console.log(this.checkoutForm.value),this.paymentService.createCashOrder(this.cartId,this.checkoutForm.value).subscribe({next:e=>{console.log(e),e.status==="success"&&(this.isLoading=!1,this.router.navigate(["/order-details"],{state:{order:e.data}}))},error:e=>{console.log(e)}}))}payByVisa(t){this.checkoutForm.valid&&(t.preventDefault(),this.isLoading=!0,this.paymentService.createVisaOrder(this.cartId,this.checkoutForm.value).subscribe({next:e=>{console.log(e),e.status==="success"?(this.isLoading=!1,console.log(e.session.url),window.open(e.session.url,"_self")):(this.isLoading=!1,console.log(e),this.router.navigate([e.session.cancel_url]))},error:e=>{this.isLoading=!1,console.log(e),this.router.navigate([e.session.cancel_url])}}))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=v({type:r,selectors:[["app-checkout"]],decls:20,vars:18,consts:[[1,"min-h-screen","py-14","bg"],[1,"container","flex","justify-center","items-center"],[1,"card","block","w-3/4","p-6","m-14","bg-white","border","border-gray-200","rounded-lg","shadow-lg","hover:bg-gray-100","transition-all","duration-200"],[1,"text-center","txt-color","font-bold","text-3xl"],[1,"text-center","second-txt-color"],[3,"formGroup"],[3,"control","inputElement","inputId","inputPlaceholder","label"],[3,"control","inputType","inputId","inputPlaceholder","label"],[1,"flex","justify-evenly","items-center"],["type","submit",1,"btn-alternate-style","flex-3/4",3,"click"],[1,"fas","fa-spinner","fa-spin","text-gray-500"],["type","submit",1,"btn-main-style","flex-3/4",3,"click"]],template:function(e,i){if(e&1&&(n(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),p(4,"Checkout"),c(),n(5,"p",4),p(6,"please Enter checkout details"),c(),n(7,"form",5),m(8,"app-input",6)(9,"app-input",7)(10,"app-input",7),n(11,"div",8)(12,"button",9),g("click",function(a){return i.payByCash(a)}),p(13,"Pay by Cash "),n(14,"span"),h(15,L,1,0,"i",10),c()(),n(16,"button",11),g("click",function(a){return i.payByVisa(a)}),p(17,"Pay by Visa/Credit-Card "),n(18,"span"),h(19,T,1,0,"i",10),c()()()()()()()),e&2){let d,a,y;o(7),s("formGroup",i.checkoutForm),o(),s("control",(d=i.checkoutForm.get("shippingAddress"))==null?null:d.get("details"))("inputElement","textarea")("inputId","details")("inputPlaceholder","Enter shipping address details...")("label","Details"),o(),s("control",(a=i.checkoutForm.get("shippingAddress"))==null?null:a.get("phone"))("inputType","tel")("inputId","phone")("inputPlaceholder","Enter your phone number...")("label","Phone Number"),o(),s("control",(y=i.checkoutForm.get("shippingAddress"))==null?null:y.get("city"))("inputType","text")("inputId","city")("inputPlaceholder","Enter your city...")("label","City"),o(5),f(i.isLoading?15:-1),o(4),f(i.isLoading?19:-1)}},dependencies:[x,_,k,F,E],encapsulation:2})};export{P as CheckoutComponent};
